<div class="card-list-container py-10">
  <div class="card w-100 mx-auto">
    <div class="card-body">
      <div class="row">
        <div class="col-12">
          <div class="d-flex">
            <%= link_to public_customer_path(@meal.customer), class: "profile-link" do %>
              <%= image_tag @meal.customer.get_profile_image, size:'40x40', class: "rounded-circle" %>
            <% end %>
            <div class="card-title">
              <%= @meal.customer.name %>
            </div>
          </div>
          <div class="d-flex ml-4">
            <p class="card-text col-12 mb-2">
              <%= @meal.body %>
            </p>
          </div>
        </div>
      </div>

      <% if @meal.image.attached? %>
      <div class="row">
        <div class="d-flex ml-4">
          <div class="col-8 ml-2">
            <%= image_tag @meal.image, class: "card-img-top img-fluid" %>
          </div>
        </div>
      </div>
      <% end %>

      <div class="col-12 ml-4 mt-4">
        <table class="table table-bordered" style="width: 500px;">
          <tr>
            <td style="width: 100px; padding-left: 5px;"><%= @meal.category %></td>
            <td style="width: 100px; padding-left: 5px;"><%= @meal.meal_summary %></td>
            <td style="width: 400px; padding-left: 5px;"><%= @meal.eat_meal %></td>
            <td style="width: 100px; padding-left: 5px;"><%= @meal.kcal %> kcal</td>
          </tr>
        </table>
          <% if @meal.customer == current_customer %>
            <div class="d-flex justify-content-end">
              <div class="form-group">
                <span><%= link_to '編集',  edit_public_meal_path(@meal), class: "btn btn-sm btn-success" %></span>
              </div>
              <div class="form-group">
                <span><%= link_to "一覧", public_meals_path, class: "btn btn-sm btn-primary" %></span>
              </div>
              <div class="form-group">
                <span><%= link_to "削除", public_meal_path(@meal.id), method: :delete, "data-confirm" => "本当に削除しますか？", class: "btn btn-sm btn-danger" %></span>
              </div>
            </div>
          <% end %>
      </div>
    </div>
  </div>
</div>


<script>
  document.getElementById('meal-card').addEventListener('click', (event) => {
    const target = event.target;
    if (target.classList.contains('profile-link')) {
      const link = target.querySelector('a');
      link.click();
    }
  });
</script>

<style>
  .card-img-top {
    border-radius: 20px;
    max-width: 95%;
    max-height: 100%;
    object-fit: contain;
  }

  .profile-link:hover {
  background-color: rgba(0, 0, 0, 0.1);
}

</style>